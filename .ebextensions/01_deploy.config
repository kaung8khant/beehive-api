option_settings:
  # Point the app root to the /public folder.
  - namespace: aws:elasticbeanstalk:container:php:phpini
    option_name: document_root
    value: /public

container_commands:
    00-check-pwd:
        command: "pwd"

    01-optimize-autoloader:
        command: "/usr/bin/composer.phar dump-autoload --optimize"

    02-optimize-config-loading:
        command: "php artisan config:cache"
        cwd: "/var/app/current"

    03-optimize-route-loading:
        command: "php artisan route:cache"
        cwd: "/var/app/current"

    04-migrate:
        command: "php artisan migrate --force"
        cwd: "/var/app/current"
        leader_only: true

    05-image-folders-create:
        command: "mkdir -p /var/app/current/storage/app/images/{large,medium,small,thumbnail,xsmall}"
        cwd: "/var/app/current"
        leader_only: true
